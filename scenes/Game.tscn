[gd_scene load_steps=14 format=2]

[ext_resource path="res://src/Game.gd" type="Script" id=1]
[ext_resource path="res://src/Camera.gd" type="Script" id=2]
[ext_resource path="res://scenes/Planet.tscn" type="PackedScene" id=3]
[ext_resource path="res://assets/meshes/skybox.obj" type="ArrayMesh" id=4]
[ext_resource path="res://assets/shaders/AtmosphereSun.shader" type="Shader" id=5]
[ext_resource path="res://assets/shaders/Stars.shader" type="Shader" id=6]
[ext_resource path="res://assets/env.tres" type="Environment" id=20]
[ext_resource path="res://scenes/GUI.tscn" type="PackedScene" id=21]

[sub_resource type="SpatialMaterial" id=1]
flags_unshaded = true
albedo_color = Color( 1, 0.803922, 0, 1 )

[sub_resource type="SphereMesh" id=2]
material = SubResource( 1 )

[sub_resource type="ShaderMaterial" id=3]
shader = ExtResource( 5 )
shader_param/u_camera_pos = null
shader_param/u_sun_pos = Vector3( 0, 0, 0 )
shader_param/u_planet_centre = Vector3( 0, 0, 0 )
shader_param/u_atmosphere_radius = 18.0
shader_param/u_planet_radius = 20.0
shader_param/u_atmosphere_samples = 20
shader_param/u_optical_samples = 5
shader_param/u_sun_intensity = 2.0
shader_param/u_scattering_strength = 0.1
shader_param/u_scattering_wavelengths = Vector3( 400, 420, 700 )
shader_param/u_density_falloff = 7.289
shader_param/u_volumetric_shadow_scale = 10.0
shader_param/u_volumetric_shadows = false
shader_param/u_phase_r = 2.374
shader_param/u_mie_scatter_coeff = 500.0
shader_param/u_mie_falloff = 20.0
shader_param/u_mie_g = 0.76

[sub_resource type="SphereMesh" id=4]
material = SubResource( 3 )
radius = 25.0
height = 50.0

[sub_resource type="ShaderMaterial" id=5]
shader = ExtResource( 6 )
shader_param/u_camera_pos = null

[node name="Game" type="Spatial"]
script = ExtResource( 1 )
PlanetScene = ExtResource( 3 )
SunRadius = 50.0

[node name="HGimbal" type="Spatial" parent="."]
script = ExtResource( 2 )
MinDistance = 10.0

[node name="VGimbal" type="Spatial" parent="HGimbal"]

[node name="Camera" type="Camera" parent="HGimbal/VGimbal"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 115.394 )
near = 1.0
far = 1100.0

[node name="Sun" type="Spatial" parent="."]

[node name="Surface" type="MeshInstance" parent="Sun"]
mesh = SubResource( 2 )
material/0 = null

[node name="Atmosphere" type="MeshInstance" parent="Sun"]
mesh = SubResource( 4 )
material/0 = null

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource( 20 )

[node name="GUI" parent="." instance=ExtResource( 21 )]
margin_left = 10.0
margin_top = 10.0

[node name="Skybox" type="MeshInstance" parent="."]
transform = Transform( 500, 0, 0, 0, 500, 0, 0, 0, 500, 0, 0, 0 )
material_override = SubResource( 5 )
mesh = ExtResource( 4 )
material/0 = null
[connection signal="on_mode_changed" from="GUI" to="." method="_on_GUI_on_mode_changed"]
